import{Bb as D,H as N,K as W,Qb as R,e as g,f as Dt,g as C,k as U,r as X}from"./chunk-JB4EPEJV.js";var E=g(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.output=h.exists=h.hash=h.bytes=h.bool=h.number=h.isBytes=void 0;function O(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}h.number=O;function K(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}h.bool=K;function z(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}h.isBytes=z;function P(t,...e){if(!z(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}h.bytes=P;function G(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");O(t.outputLen),O(t.blockLen)}h.hash=G;function J(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}h.exists=J;function Q(t,e){P(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}h.output=Q;var Rt={number:O,bool:K,bytes:P,hash:G,exists:J,output:Q};h.default=Rt});var Bt=g(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.add5L=c.add5H=c.add4H=c.add4L=c.add3H=c.add3L=c.add=c.rotlBL=c.rotlBH=c.rotlSL=c.rotlSH=c.rotr32L=c.rotr32H=c.rotrBL=c.rotrBH=c.rotrSL=c.rotrSH=c.shrSL=c.shrSH=c.toBig=c.split=c.fromBig=void 0;var H=BigInt(2**32-1),j=BigInt(32);function M(t,e=!1){return e?{h:Number(t&H),l:Number(t>>j&H)}:{h:Number(t>>j&H)|0,l:Number(t&H)|0}}c.fromBig=M;function Y(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){let{h:i,l:a}=M(t[s],e);[r[s],n[s]]=[i,a]}return[r,n]}c.split=Y;var Z=(t,e)=>BigInt(t>>>0)<<j|BigInt(e>>>0);c.toBig=Z;var tt=(t,e,r)=>t>>>r;c.shrSH=tt;var et=(t,e,r)=>t<<32-r|e>>>r;c.shrSL=et;var rt=(t,e,r)=>t>>>r|e<<32-r;c.rotrSH=rt;var nt=(t,e,r)=>t<<32-r|e>>>r;c.rotrSL=nt;var st=(t,e,r)=>t<<64-r|e>>>r-32;c.rotrBH=st;var ot=(t,e,r)=>t>>>r-32|e<<64-r;c.rotrBL=ot;var it=(t,e)=>e;c.rotr32H=it;var ct=(t,e)=>t;c.rotr32L=ct;var at=(t,e,r)=>t<<r|e>>>32-r;c.rotlSH=at;var ut=(t,e,r)=>e<<r|t>>>32-r;c.rotlSL=ut;var lt=(t,e,r)=>e<<r-32|t>>>64-r;c.rotlBH=lt;var ht=(t,e,r)=>t<<r-32|e>>>64-r;c.rotlBL=ht;function ft(t,e,r,n){let s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}c.add=ft;var pt=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0);c.add3L=pt;var dt=(t,e,r,n)=>e+r+n+(t/2**32|0)|0;c.add3H=dt;var bt=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0);c.add4L=bt;var yt=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0;c.add4H=yt;var kt=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0);c.add5L=kt;var gt=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0;c.add5H=gt;var Kt={fromBig:M,split:Y,toBig:Z,shrSH:tt,shrSL:et,rotrSH:rt,rotrSL:nt,rotrBH:st,rotrBL:ot,rotr32H:it,rotr32L:ct,rotlSH:at,rotlSL:ut,rotlBH:lt,rotlBL:ht,add:ft,add3L:pt,add3H:dt,add4L:bt,add4H:yt,add5H:gt,add5L:kt};c.default=Kt});var mt=g(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.crypto=void 0;T.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var Lt=g(o=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.randomBytes=o.wrapXOFConstructorWithOpts=o.wrapConstructorWithOpts=o.wrapConstructor=o.checkOpts=o.Hash=o.concatBytes=o.toBytes=o.utf8ToBytes=o.asyncLoop=o.nextTick=o.hexToBytes=o.bytesToHex=o.byteSwap32=o.byteSwapIfBE=o.byteSwap=o.isLE=o.rotl=o.rotr=o.createView=o.u32=o.u8=o.isBytes=void 0;var F=mt(),V=E();function zt(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}o.isBytes=zt;var Gt=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength);o.u8=Gt;var Jt=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));o.u32=Jt;var Qt=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);o.createView=Qt;var Yt=(t,e)=>t<<32-e|t>>>e;o.rotr=Yt;var Zt=(t,e)=>t<<e|t>>>32-e>>>0;o.rotl=Zt;o.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var te=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;o.byteSwap=te;o.byteSwapIfBE=o.isLE?t=>t:t=>(0,o.byteSwap)(t);function ee(t){for(let e=0;e<t.length;e++)t[e]=(0,o.byteSwap)(t[e])}o.byteSwap32=ee;var re=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ne(t){(0,V.bytes)(t);let e="";for(let r=0;r<t.length;r++)e+=re[t[r]];return e}o.bytesToHex=ne;var f={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function wt(t){if(t>=f._0&&t<=f._9)return t-f._0;if(t>=f._A&&t<=f._F)return t-(f._A-10);if(t>=f._a&&t<=f._f)return t-(f._a-10)}function se(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){let a=wt(t.charCodeAt(i)),l=wt(t.charCodeAt(i+1));if(a===void 0||l===void 0){let d=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+i)}n[s]=a*16+l}return n}o.hexToBytes=se;var oe=()=>C(o,null,function*(){});o.nextTick=oe;function ie(t,e,r){return C(this,null,function*(){let n=Date.now();for(let s=0;s<t;s++){r(s);let i=Date.now()-n;i>=0&&i<e||(yield(0,o.nextTick)(),n+=i)}})}o.asyncLoop=ie;function xt(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}o.utf8ToBytes=xt;function A(t){return typeof t=="string"&&(t=xt(t)),(0,V.bytes)(t),t}o.toBytes=A;function ce(...t){let e=0;for(let n=0;n<t.length;n++){let s=t[n];(0,V.bytes)(s),e+=s.length}let r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){let i=t[n];r.set(i,s),s+=i.length}return r}o.concatBytes=ce;var q=class{clone(){return this._cloneInto()}};o.Hash=q;var ae={}.toString;function ue(t,e){if(e!==void 0&&ae.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(t,e)}o.checkOpts=ue;function le(t){let e=n=>t().update(A(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}o.wrapConstructor=le;function he(t){let e=(n,s)=>t(s).update(A(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}o.wrapConstructorWithOpts=he;function fe(t){let e=(n,s)=>t(s).update(A(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}o.wrapXOFConstructorWithOpts=fe;function pe(t=32){if(F.crypto&&typeof F.crypto.getRandomValues=="function")return F.crypto.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}o.randomBytes=pe});var vt=g(u=>{"use strict";Object.defineProperty(u,"__esModule",{value:!0});u.shake256=u.shake128=u.keccak_512=u.keccak_384=u.keccak_256=u.keccak_224=u.sha3_512=u.sha3_384=u.sha3_256=u.sha3_224=u.Keccak=u.keccakP=void 0;var m=E(),x=Bt(),p=Lt(),It=[],Ot=[],Ht=[],de=BigInt(0),w=BigInt(1),be=BigInt(2),ye=BigInt(7),ke=BigInt(256),ge=BigInt(113);for(let t=0,e=w,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],It.push(2*(5*n+r)),Ot.push((t+1)*(t+2)/2%64);let s=de;for(let i=0;i<7;i++)e=(e<<w^(e>>ye)*ge)%ke,e&be&&(s^=w<<(w<<BigInt(i))-w);Ht.push(s)}var[Be,me]=(0,x.split)(Ht,!0),_t=(t,e,r)=>r>32?(0,x.rotlBH)(t,e,r):(0,x.rotlSH)(t,e,r),St=(t,e,r)=>r>32?(0,x.rotlBL)(t,e,r):(0,x.rotlSL)(t,e,r);function Tt(t,e=24){let r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let a=0;a<10;a++)r[a]=t[a]^t[a+10]^t[a+20]^t[a+30]^t[a+40];for(let a=0;a<10;a+=2){let l=(a+8)%10,d=(a+2)%10,B=r[d],k=r[d+1],Nt=_t(B,k,1)^r[l],Wt=St(B,k,1)^r[l+1];for(let I=0;I<50;I+=10)t[a+I]^=Nt,t[a+I+1]^=Wt}let s=t[2],i=t[3];for(let a=0;a<24;a++){let l=Ot[a],d=_t(s,i,l),B=St(s,i,l),k=It[a];s=t[k],i=t[k+1],t[k]=d,t[k+1]=B}for(let a=0;a<50;a+=10){for(let l=0;l<10;l++)r[l]=t[a+l];for(let l=0;l<10;l++)t[a+l]^=~r[(l+2)%10]&r[(l+4)%10]}t[0]^=Be[n],t[1]^=me[n]}r.fill(0)}u.keccakP=Tt;var L=class t extends p.Hash{constructor(e,r,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,m.number)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,p.u32)(this.state)}keccak(){p.isLE||(0,p.byteSwap32)(this.state32),Tt(this.state32,this.rounds),p.isLE||(0,p.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(e){(0,m.exists)(this);let{blockLen:r,state:n}=this;e=(0,p.toBytes)(e);let s=e.length;for(let i=0;i<s;){let a=Math.min(r-this.pos,s-i);for(let l=0;l<a;l++)n[this.pos++]^=e[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:r,pos:n,blockLen:s}=this;e[n]^=r,r&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){(0,m.exists)(this,!1),(0,m.bytes)(e),this.finish();let r=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();let a=Math.min(n-this.posOut,i-s);e.set(r.subarray(this.posOut,this.posOut+a),s),this.posOut+=a,s+=a}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,m.number)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,m.output)(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:r,suffix:n,outputLen:s,rounds:i,enableXOF:a}=this;return e||(e=new t(r,n,s,a,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=a,e.destroyed=this.destroyed,e}};u.Keccak=L;var b=(t,e,r)=>(0,p.wrapConstructor)(()=>new L(e,t,r));u.sha3_224=b(6,144,224/8);u.sha3_256=b(6,136,256/8);u.sha3_384=b(6,104,384/8);u.sha3_512=b(6,72,512/8);u.keccak_224=b(1,144,224/8);u.keccak_256=b(1,136,256/8);u.keccak_384=b(1,104,384/8);u.keccak_512=b(1,72,512/8);var At=(t,e,r)=>(0,p.wrapXOFConstructorWithOpts)((n={})=>new L(e,t,n.dkLen===void 0?r:n.dkLen,!0));u.shake128=At(31,168,128/8);u.shake256=At(31,136,256/8)});var qt=g((je,y)=>{"use strict";var{sha3_512:we}=vt(),Ut=24,_=32,$=(t=4,e=Math.random)=>{let r="";for(;r.length<t;)r=r+Math.floor(e()*36).toString(36);return r};function Pt(t){let e=8n,r=0n;for(let n of t.values()){let s=BigInt(n);r=(r<<e)+s}return r}var Et=(t="")=>Pt(we(t)).toString(36).slice(1),Ct=Array.from({length:26},(t,e)=>String.fromCharCode(e+97)),xe=t=>Ct[Math.floor(t()*Ct.length)],jt=({globalObj:t=typeof global<"u"?global:typeof window<"u"?window:{},random:e=Math.random}={})=>{let r=Object.keys(t).toString(),n=r.length?r+$(_,e):$(_,e);return Et(n).substring(0,_)},Mt=t=>()=>t++,Le=476782367,Ft=({random:t=Math.random,counter:e=Mt(Math.floor(t()*Le)),length:r=Ut,fingerprint:n=jt({random:t})}={})=>function(){let i=xe(t),a=Date.now().toString(36),l=e().toString(36),d=$(r,t),B=`${a+d+l+n}`;return`${i+Et(B).substring(1,r)}`},_e=Ft(),Se=(t,{minLength:e=2,maxLength:r=_}={})=>{let n=t.length,s=/^[0-9a-z]+$/;try{if(typeof t=="string"&&n>=e&&n<=r&&s.test(t))return!0}finally{}return!1};y.exports.getConstants=()=>({defaultLength:Ut,bigLength:_});y.exports.init=Ft;y.exports.createId=_e;y.exports.bufToBigInt=Pt;y.exports.createCounter=Mt;y.exports.createFingerprint=jt;y.exports.isCuid=Se});var Vt=g((Me,S)=>{"use strict";var{createId:Ie,init:Oe,getConstants:He,isCuid:Te}=qt();S.exports.createId=Ie;S.exports.init=Oe;S.exports.getConstants=He;S.exports.isCuid=Te});var $t=Dt(Vt()),v=class{id=(0,$t.createId)();items=[];shippingPrice=0};var Xt=class t{constructor(e){this.http=e}baseUrl=R.apiUrl;basketSource=new U(null);basketSource$=this.basketSource.asObservable();basketTotalSource=new U(null);basketTotalSource$=this.basketTotalSource.asObservable();createPaymentIntent(){return this.http.post(this.baseUrl+"payments/"+this.getCurrentBasketValue()?.id,{}).pipe(X(e=>{this.basketSource.next(e)}))}setShippingPrice(e){let r=this.getCurrentBasketValue();r&&(r.shippingPrice=e.price,r.deliveryMetodId=e.id,this.setBasket(r))}getBasket(e){return this.http.get(this.baseUrl+"basket?id="+e).subscribe({next:r=>{this.basketSource.next(r),this.calculateTotals()}})}setBasket(e){return this.http.post(this.baseUrl+"basket",e).subscribe({next:r=>{this.basketSource.next(r),this.calculateTotals()}})}getCurrentBasketValue(){return this.basketSource.value}addItemToBasket(e,r=1){this.isProduct(e)&&(e=this.mapProductItemToBasketItem(e));let n=this.getCurrentBasketValue()??this.createBasket();n.items=this.addOrUpdateItem(n.items,e,r),this.setBasket(n)}removeItemFromBasket(e,r=1){let n=this.getCurrentBasketValue();if(!n)return;let s=n.items.find(i=>i.id===e);s&&(s.quantity-=r,s.quantity===0&&(n.items=n.items.filter(i=>i.id!==e)),n.items.length>0?this.setBasket(n):this.deleteBasket(n))}deleteBasket(e){return this.http.delete(this.baseUrl+"basket?id="+e.id).subscribe({next:()=>{this.deleteLocalBasket()}})}deleteLocalBasket(){this.basketSource.next(null),this.basketTotalSource.next(null),localStorage.removeItem("basket_id")}addOrUpdateItem(e,r,n){let s=e.find(i=>i.id===r.id);return s?s.quantity+=n:(r.quantity=n,e.push(r)),e}createBasket(){let e=new v;return localStorage.setItem("basket_id",e.id),e}mapProductItemToBasketItem(e){return{id:e.id,productName:e.name,price:e.price,quantity:0,pictureUrl:e.pictureUrl,brand:e.productBrand,type:e.productType}}calculateTotals(){let e=this.getCurrentBasketValue();if(!e)return;let r=e.items.reduce((s,i)=>i.price*i.quantity+s,0),n=r+e.shippingPrice;this.basketTotalSource.next({shipping:e.shippingPrice,total:n,subtotal:r})}isProduct(e){return e.productBrand!==void 0}static \u0275fac=function(r){return new(r||t)(W(D))};static \u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"})};export{Xt as a};
